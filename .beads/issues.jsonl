{"id":"mssg-08h","title":"URL paths in templates have escaped forward slashes","description":"## Problem\n\nWhen rendering templates, URL paths like `articles/2025-12-15-rust-error-handling.html` are being escaped to `articles\u0026#x2f;2025-12-15-rust-error-handling.html`.\n\nThe forward slash (`/`) is being converted to `\u0026#x2f;` by minijinja's HTML auto-escaping.\n\n## Root Cause\n\nIn `template.rs`, the `filename` field of `ContentItem` is passed as a regular `String`. Minijinja's auto-escaping then escapes the forward slash in HTML attribute contexts (following OWASP XSS prevention recommendations).\n\n## Solution\n\nAdd a `url` filter to the minijinja environment that marks URL paths as safe, bypassing auto-escaping for path separators while still being safe for HTML contexts.\n\nUse `Value::from_safe_string()` to mark the result as pre-escaped.\n\n## Affected Code\n\n- `src/template.rs:44-49` and `src/template.rs:69-74` - where filename is constructed\n- `src/template.rs:17-21` and `src/template.rs:26-29` - where environment is created\n\n## Test Case\n\nTemplates with `href=\"/{{ item.filename }}\"` render as `href=\"/articles\u0026#x2f;my-post.html\"` instead of `href=\"/articles/my-post.html\"`","status":"tombstone","priority":1,"issue_type":"bug","created_at":"2025-12-23T16:13:41.564337+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Added url filter to mark URL paths as safe. Templates should use {{ item.filename | url }} to prevent forward slash escaping.","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"mssg-1y8","title":"Add verify task to mise.toml for edit-test loop","description":"Add a 'verify' task that runs both linting and tests in sequence. This enforces the edit-test loop pattern recommended for AI-assisted development.\n\nImplementation:\n- Add [tasks.verify] to mise.toml\n- Run: cargo clippy -- -D warnings \u0026\u0026 cargo test\n- Update CLAUDE.md to reference the new task","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-22T21:39:53.806977+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Closed","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mssg-559","title":"Refactor watch logic to allow testing of watched paths","description":"Extract the logic for determining which paths to watch into a separate function so we can verify that the config file is included in the watch list via unit tests.","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-20T21:47:09.264451+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Function extracted and test added in commit b073b6d","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mssg-6ii","title":"Enable syntax highlighting","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-22T18:20:35.711852+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Closed","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mssg-6xl","title":"Syntax highlighter parsing bug: stops at first \u003e closing pre tag","description":"The highlight_html parser looks for the first '\u003e' to find the end of the opening tag, but this stops at '\u003cpre\u003e' instead of '\u003ccode class=\"language-*\"\u003e'. Result: the \u003ccode...\u003e tag is fed into the highlighter as text content instead of being parsed as markup.","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-22T21:07:06.067024+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Fixed by adjusting tag parsing to skip \u003cpre\u003e and find the closing \u003e of \u003ccode\u003e tag","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"mssg-9xx","title":"Pass all_content variable to templates for tags counting","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-22T18:20:54.487394+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Closed","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mssg-dn7","title":"Add test coverage with cargo tarpaulin","description":"Add cargo tarpaulin for test coverage metrics to ensure AI-generated code is properly tested.\n\nImplementation:\n1. Add coverage task to mise.toml: cargo tarpaulin --out Html\n2. Document coverage workflow in CLAUDE.md\n3. Consider adding coverage threshold enforcement","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-22T21:39:54.184833+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Closed","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mssg-f4r","title":"Use more efficient HTML unescape implementation","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-24T22:11:39.847932+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mssg-gnk","title":"Add watch subcommand for live rebuilds","description":"Add marie-ssg watch command that monitors src/ and templates/ directories for changes and automatically triggers a rebuild when files change. This enables a faster development workflow without manually re-running build after each edit.","status":"tombstone","priority":2,"issue_type":"feature","created_at":"2025-12-20T11:31:09.788006+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Implemented watch subcommand with fsevent for macOS","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"feature"}
{"id":"mssg-kxv","title":"Update tests in src/content.rs to improve coverage","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-24T23:31:50.118136+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Closed","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mssg-mjq","title":"Watch mode doesn't reload on config file changes","description":"The watch mode currently only watches content_dir, template_dir, and static_dir. It should also watch the config file itself (e.g., site.toml) so that changes to configuration (like site title, etc.) trigger a rebuild.","status":"tombstone","priority":1,"issue_type":"bug","created_at":"2025-12-20T21:33:54.615373+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Closed","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"mssg-myp","title":"Implement sitemap.xml generation","description":"## Feature\n\nGenerate a sitemap.xml file during site build to improve SEO and search engine discoverability.\n\n## Requirements\n\n- Generate sitemap.xml in the output root directory\n- Include all HTML pages with their URLs\n- Use the domain from site.toml config\n- Include lastmod dates from content metadata\n- Follow the sitemap protocol: https://www.sitemaps.org/protocol.html\n\n## Implementation Notes\n\n- Add sitemap generation after content rendering in the build pipeline\n- Consider adding optional sitemap configuration in site.toml (e.g., exclude patterns, priority settings)\n- Use the existing content metadata (date) for lastmod values","status":"tombstone","priority":2,"issue_type":"feature","created_at":"2025-12-24T01:42:43.42861+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Implemented sitemap.xml generation with 8 unit tests and 1 integration test. Sitemap includes homepage, content type indexes, and all content pages with lastmod dates.","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"feature"}
{"id":"mssg-psj","title":"Expand CLAUDE.md with common development patterns","description":"Add concrete examples to CLAUDE.md for common development tasks. This helps AI assistants understand how to make changes correctly on the first attempt.\n\nPatterns to document:\n1. How to add a new content type\n2. How to add a new template variable\n3. How to add a new CLI flag\n4. Common error patterns and fixes\n\nEach pattern should include:\n- Step-by-step instructions\n- Relevant files to modify\n- Example code snippets","status":"tombstone","priority":2,"issue_type":"task","created_at":"2025-12-22T21:39:53.996085+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Closed","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"task"}
{"id":"mssg-q51","title":"Fix watch mode not reloading templates","status":"tombstone","priority":1,"issue_type":"bug","created_at":"2025-12-20T21:12:14.084903+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Fixed by creating fresh template environment on each watch rebuild","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
{"id":"mssg-vh1","title":"Release 0.9.0","description":"Collecting the last set of changes for 0.9.0","status":"in_progress","priority":1,"issue_type":"epic","created_at":"2025-12-25T21:26:21.722873+01:00","updated_at":"2025-12-29T23:43:26.342258+01:00"}
{"id":"mssg-vh1.1","title":"Fix missing mise tasks (verify, tests)","description":"The verify and tests tasks were removed during mise.toml refactoring but are still referenced in CLAUDE.md. Need to restore them.\n\n## Summary of Changes\n\nAdded to mise.toml:\n- `tests`: Run all tests with --nocapture\n- `verify`: Full verification (lint + tests) before commit\n\nBoth tasks tested and working.\n\nAcceptance Criteria:\n- [x] mise run tests works (runs all tests)\n- [x] mise run verify works (runs lint + tests)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T23:42:47.282351+01:00","created_by":"l1x","updated_at":"2025-12-30T00:30:26.492029+01:00","closed_at":"2025-12-30T00:30:26.492036+01:00"}
{"id":"mssg-vh1.10","title":"Review 0.9.0 release changes","description":"Review all changes in the 0.9.0 release before tagging.\n\n## Changes to Review\n\n### Dependencies\n- [ ] `chrono` → `time` + `kiters` migration\n- [ ] `basic-toml` → `toml` migration\n- [ ] `autumnus` language feature flags (10 languages instead of 91)\n\n### Code Changes\n- [ ] src/main.rs - tracing initialization with UTC timestamps\n- [ ] src/content.rs - time crate integration, toml parsing\n- [ ] src/config.rs - toml parsing\n- [ ] src/template.rs - date formatting\n- [ ] src/sitemap.rs - time crate integration\n\n### Configuration\n- [ ] Cargo.toml - dependencies and features\n- [ ] mise.toml - restored tasks\n\n### Documentation\n- [ ] README.md - v0.9.0 changelog\n- [ ] docs/toml-migration.md - migration guide\n\n### Verification\n- [ ] All 99 tests pass\n- [ ] Binary size reduced (80MB → 9MB)\n- [ ] Release build succeeds","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-30T10:19:33.306274+01:00","created_by":"l1x","updated_at":"2025-12-30T10:19:33.306274+01:00","dependencies":[{"issue_id":"mssg-vh1.10","depends_on_id":"mssg-vh1","type":"parent-child","created_at":"2025-12-30T10:19:33.307094+01:00","created_by":"daemon"}]}
{"id":"mssg-vh1.11","title":"Fix UTF-8 byte corruption in HTML entity parsing","description":"**Location:** `src/syntax.rs:91-142`\n\n**Issue:** `out.push(bytes[i] as char)` treats any byte (0-255) as a valid char, but bytes 128-255 are not valid standalone UTF-8 characters.\n\n**Impact:** Non-ASCII input in code blocks can cause silent data corruption.\n\n**Demonstrated:**\n- Input: `\"café\"` → Output: `\"cafÃ©\"` (corrupted)\n- UTF-8 bytes for 'é' (0xC3 0xA9 = 195, 169) split into separate chars\n\n**Test:** `test_unescape_html_entities_utf8_preservation`\n\n## Fix\n\nReplaced byte-by-byte iteration with string slicing in `unescape_html_entities()`.\n\n**Before (buggy):**\n```rust\nlet bytes = input.as_bytes();\nwhile i \u003c bytes.len() {\n    if bytes[i] != b'\u0026' {\n        out.push(bytes[i] as char);  // Corrupts multi-byte UTF-8\n        i += 1;\n        continue;\n    }\n    // ...\n}\n```\n\n**After (fixed):**\n```rust\nlet mut remaining = input;\nwhile let Some(amp_pos) = remaining.find('\u0026') {\n    out.push_str(\u0026remaining[..amp_pos]);  // Preserves UTF-8\n    remaining = \u0026remaining[amp_pos..];\n    // ...\n}\nout.push_str(remaining);  // Copy remaining content\n```\n\n**Key insight:** HTML entities are ASCII-only (`\u0026lt;`, `\u0026#39;`, etc.), so `find('\u0026')` and `find(';')` safely return byte positions at UTF-8 boundaries. Using `push_str()` for non-entity content preserves all multi-byte characters.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-30T10:35:35.738401+01:00","created_by":"l1x","updated_at":"2025-12-30T10:45:08.188984+01:00","closed_at":"2025-12-30T10:44:16.680982+01:00","close_reason":"Fixed by replacing byte indexing with string slicing. All 100 tests pass."}
{"id":"mssg-vh1.12","title":"Replace .expect() panics with proper error handling","description":"**Locations:**\n- `src/main.rs:86,94,256` - config loading\n- `src/template.rs:15-17` - date formatting\n- `src/utils.rs:110-111` - date formatting\n- `src/sitemap.rs:74-75` - date formatting\n\n**Issue:** Uses `.expect()` which panics on error instead of propagating errors properly.\n\n**Impact:** Ungraceful crashes instead of user-friendly error messages.\n\n## Fix\n\n### Config Loading (main.rs, config.rs)\n\n**Before:**\n```rust\nlet config = Config::load_from_file(config_file).expect(\"Failed to load configuration\");\n```\n\n**After:**\n```rust\n// config.rs - return proper error type\npub fn load_from_file(path: \u0026str) -\u003e Result\u003cSelf, ConfigError\u003e { ... }\n\n// main.rs - propagate error with ?\nlet config = Config::load_from_file(config_file)?;\n\n// main.rs - exit with non-zero code on error\nif let Err(e) = build(\u0026args.config_file) {\n    error!(\"{:?}\", e);\n    std::process::exit(1);\n}\n```\n\n### Date Formatting (template.rs, utils.rs, sitemap.rs)\n\n**Before:**\n```rust\nlet format = time::format_description::parse(\"[year]-[month]-[day]\").expect(\"valid format\");\ndate.format(\u0026format).expect(\"valid date\")\n```\n\n**After:**\n```rust\n// Format validated at compile time via macro\nconst FORMAT: \u0026[time::format_description::FormatItem\u003c'static\u003e] =\n    format_description!(\"[year]-[month]-[day]\");\ndate.format(\u0026FORMAT).unwrap_or_else(|_| \"0000-00-00\".to_string())\n```\n\n**Key improvements:**\n- Compile-time format validation eliminates runtime parse errors\n- Graceful fallbacks instead of panics\n- Proper exit codes for CLI error handling","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-30T10:35:35.88301+01:00","created_by":"l1x","updated_at":"2025-12-30T10:51:29.985821+01:00","closed_at":"2025-12-30T10:51:29.985821+01:00","close_reason":"Replaced all .expect() with proper error handling. All 100 tests pass."}
{"id":"mssg-vh1.13","title":"Remove unnecessary PathBuf cloning in parallel loop","description":"**Location:** `src/main.rs:131-161`, `src/content.rs:269-303`\n\n**Issue:** `file.clone()` called twice per file during parallel content loading.\n\n**Impact:** Extra allocations for sites with thousands of files.\n\n## Fix\n\n### Problem Analysis\n```rust\n// Before: 2 clones per file\nlet html = convert_content_with_highlighting(\u0026content, file.clone(), ...)?;  // Clone #1\nOk(LoadedContent { path: file.clone(), ... })  // Clone #2\n```\n\nThe function took `PathBuf` by value but only used it for error messages (rare case).\n\n### Solution\n\n**1. Change function signature** (`src/content.rs:271`):\n```rust\n// Before\nfn convert_content_with_highlighting(content: \u0026Content, path: PathBuf, ...) \n\n// After  \nfn convert_content_with_highlighting(content: \u0026Content, path: \u0026Path, ...)\n```\n\n**2. Clone only on error** (`src/content.rs:281,295`):\n```rust\nErr(ContentError::MarkdownParsingFailed {\n    path: path.to_path_buf(),  // Clone only when error occurs\n    message: e.to_string(),\n})\n```\n\n**3. Use into_par_iter()** (`src/main.rs:132`):\n```rust\n// Before: par_iter() gives \u0026PathBuf, requires clone\nfiles.par_iter().map(|file| { file.clone() ... })\n\n// After: into_par_iter() gives owned PathBuf, no clone needed\nfiles.into_par_iter().map(|file| { file ... })\n```\n\n### Result\n| Scenario | Before | After |\n|----------|--------|-------|\n| Happy path | 2 clones | 0 clones |\n| Error path | 2 clones | 1 clone |","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T10:35:36.026505+01:00","created_by":"l1x","updated_at":"2025-12-30T11:11:08.517358+01:00","closed_at":"2025-12-30T11:11:08.517358+01:00","close_reason":"Eliminated 2 PathBuf clones per file in happy path. All 100 tests pass."}
{"id":"mssg-vh1.14","title":"Reduce excessive cloning in template rendering","description":"**Location:** `src/template.rs:56-122`\n\n**Issue:** Heavy cloning of `html`, `meta`, and other fields when building ContentItem for templates. The same 20+ lines of code were duplicated for building `contents` and `all_contents` lists.\n\n**Impact:** Code duplication, harder maintenance, and no single source of truth for ContentItem construction.\n\n## Fix\n\nExtracted a helper function `build_content_item()` that encapsulates the common logic:\n\n```rust\n/// Build a ContentItem from LoadedContent for template rendering.\nfn build_content_item(lc: \u0026crate::LoadedContent, config: \u0026Config) -\u003e ContentItem {\n    let filename = lc.output_path\n        .strip_prefix(\u0026config.site.output_dir)\n        .unwrap_or(\u0026lc.output_path)\n        .to_string_lossy()\n        .to_string();\n    let excerpt = get_excerpt_html(\u0026lc.content.data, \"## Context\");\n\n    ContentItem {\n        html: lc.html.clone(),\n        meta: lc.content.meta.clone(),\n        formatted_date: format_date_long(\u0026lc.content.meta.date),\n        filename,\n        content_type: lc.content_type.clone(),\n        excerpt,\n    }\n}\n```\n\nRefactored `render_index_from_loaded` to use the helper:\n\n```rust\nlet mut contents: Vec\u003cContentItem\u003e = loaded\n    .iter()\n    .map(|lc| build_content_item(lc, config))\n    .collect();\ncontents.sort_by(|a, b| b.meta.date.cmp(\u0026a.meta.date));\n\nlet mut all_contents: Vec\u003cContentItem\u003e = all_content\n    .iter()\n    .map(|lc| build_content_item(lc, config))\n    .collect();\nall_contents.sort_by(|a, b| b.meta.date.cmp(\u0026a.meta.date));\n```\n\n**Note:** The cloning is still necessary because minijinja requires owned values for serialization. However, this refactoring:\n- Eliminates 20+ lines of duplicate code\n- Provides single source of truth for ContentItem construction\n- Makes future optimization easier (e.g., caching ContentItems)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T10:35:36.177082+01:00","created_by":"l1x","updated_at":"2025-12-30T12:00:46.437742+01:00","closed_at":"2025-12-30T12:00:46.437742+01:00","close_reason":"Closed"}
{"id":"mssg-vh1.15","title":"Fix O(n²) string processing in syntax highlighting","description":"**Location:** `src/syntax.rs:154-227`\n\n**Original Issue:** Claimed O(n²) complexity due to re-scanning from beginning for each code block.\n\n## Analysis\n\n**The original assessment was incorrect.** The current implementation is already **O(n)**.\n\nThe `highlight_html` function uses a shrinking slice pattern:\n\n```rust\nlet mut remaining = html;\n\nwhile let Some(start_idx) = remaining.find(\"\u003cpre\u003e\u003ccode\") {\n    result.push_str(\u0026remaining[..start_idx]);  // Copy content before block\n    // ... process code block ...\n    remaining = \u0026remaining[block_end..];  // Slice off processed portion\n}\n\nresult.push_str(remaining);  // Copy any remaining content\n```\n\n**Why this is O(n):**\n1. `remaining` shrinks after each iteration via `\u0026remaining[block_end..]`\n2. `find()` only searches the unprocessed portion, not the full string\n3. Each character is scanned at most once and copied at most once\n\n**What O(n²) would look like (NOT what the code does):**\n```rust\nwhile let Some(idx) = html.find(\"\u003cpre\u003e\u003ccode\") {  // Always search FULL string\n    // This would re-scan already-processed portions\n}\n```\n\n## Resolution\n\nNo changes needed. The implementation is already optimally efficient for this approach.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T10:36:13.468214+01:00","created_by":"l1x","updated_at":"2025-12-30T12:08:25.093088+01:00","closed_at":"2025-12-30T12:08:25.093088+01:00","close_reason":"No changes needed - implementation is already O(n), not O(n²) as originally claimed"}
{"id":"mssg-vh1.16","title":"Add static file metadata caching","description":"**Location:** `src/output.rs:16-42`\n\n**Issue:** `fs::metadata()` called twice per file (source and dest) during static file copying.\n\n**Impact:** Significant I/O overhead for large static directories.\n\n**Fix:** Cache metadata or use single comparison syscall.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T10:36:13.618457+01:00","created_by":"l1x","updated_at":"2025-12-30T12:34:07.565549+01:00","closed_at":"2025-12-30T12:34:07.565549+01:00","close_reason":"Micro-optimization not worth implementing. The ticket misunderstands the code: metadata() is called on TWO DIFFERENT files (source and dest) - both are required for comparison. There's no redundancy. WalkDir could provide cached source metadata, but savings would be ~microseconds for typical sites. The real cost is file copying, which should_copy_file already optimizes by skipping unchanged files."}
{"id":"mssg-vh1.17","title":"Remove dead code: unused convert_content function","description":"**Location:** `src/content.rs:219`\n\n**Issue:** `convert_content()` is marked `#[allow(dead_code)]` and unused - superseded by `convert_content_with_highlighting()`.\n\n**Fix:** Remove the unused function.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T10:36:13.76764+01:00","created_by":"l1x","updated_at":"2025-12-30T12:15:17.070647+01:00","closed_at":"2025-12-30T12:15:17.070647+01:00","close_reason":"Removed unused convert_content() function and its 2 tests. Function was superseded by convert_content_with_highlighting(). Net -72 lines of dead code."}
{"id":"mssg-vh1.18","title":"Improve error handling in excerpt extraction","description":"**Location:** `src/content.rs:355-361`\n\n**Issue:** When excerpt markdown conversion fails, returns empty string with only a warning log.\n\n**Impact:** Users won't know their excerpts aren't being generated.\n\n**Fix:** Consider propagating error or making fallback behavior more explicit.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-30T10:36:13.919825+01:00","created_by":"l1x","updated_at":"2025-12-30T10:36:13.919825+01:00"}
{"id":"mssg-vh1.19","title":"Fix TOCTOU race condition in file copy","description":"**Location:** `src/output.rs:140-148`\n\n**Issue:** `exists()` check followed by `copy()` - file could be deleted between check and copy.\n\n**Fix:** Remove pre-check and handle error from `copy()` directly.","status":"closed","priority":3,"issue_type":"bug","created_at":"2025-12-30T10:36:27.424629+01:00","created_by":"l1x","updated_at":"2025-12-30T12:28:57.662553+01:00","closed_at":"2025-12-30T12:28:57.662553+01:00","close_reason":"Not a real bug - TOCTOU false positive. The exists() pre-check provides a clear error message ('Root static file not found') that would be lost if removed. In this context (single-threaded SSG building local files), the probability of a file being deleted between exists() and copy() is effectively zero. The pre-check is defensive programming that improves UX, not a vulnerability."}
{"id":"mssg-vh1.2","title":"Bump version to 0.9.0","description":"Update version in Cargo.toml from 0.8.1 to 0.9.0\n\nAcceptance Criteria:\n- [ ] Cargo.toml version = \"0.9.0\"\n- [ ] cargo build succeeds","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T23:42:47.405559+01:00","created_by":"l1x","updated_at":"2025-12-30T10:12:29.196797+01:00","closed_at":"2025-12-30T10:12:29.196797+01:00","close_reason":"Version bumped to 0.9.0, build succeeds"}
{"id":"mssg-vh1.20","title":"Add logging for silent content type fallback","description":"**Location:** `src/utils.rs:37-44`\n\n**Issue:** `get_content_type()` silently falls back to \"page\" via `.unwrap_or(\"page\")` with no logging.\n\n**Impact:** Misconfigurations go unnoticed.\n\n**Fix:** Add debug logging when fallback occurs.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T10:36:27.555711+01:00","created_by":"l1x","updated_at":"2025-12-30T12:36:06.625548+01:00","closed_at":"2025-12-30T12:36:06.625548+01:00","close_reason":"Not worth implementing - the fallback to 'page' is documented, intentional behavior for root-level content files (e.g., content/about.md → type 'page'). Adding debug logging would create noise for normal use. The only other fallback case (file outside content_dir) can't occur because find_markdown_files() only returns files from content_dir."}
{"id":"mssg-vh1.21","title":"Improve robustness of HTML parsing in syntax highlighter","description":"**Location:** `src/syntax.rs:172-227`\n\n**Issue:** Hand-coded HTML parsing assumes specific formats:\n- Expects double quotes for attributes\n- No handling of escaped quotes\n- Assumes `\u003c/code\u003e\u003c/pre\u003e` order\n\n**Impact:** Edge cases with non-standard HTML could break highlighting.\n\n**Fix:** Consider using a lightweight HTML parser or add more defensive parsing.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T10:36:27.687638+01:00","created_by":"l1x","updated_at":"2025-12-30T12:32:24.687427+01:00","closed_at":"2025-12-30T12:32:24.687427+01:00","close_reason":"Not a real issue - the HTML parser is designed for markdown-generated HTML only, which is predictable and consistent. The markdown crate (GFM) always produces: (1) double-quoted class attributes, (2) no escaped quotes in language identifiers, (3) \u003c/code\u003e\u003c/pre\u003e order. Using a full HTML parser would be over-engineering for this controlled input. All 10+ test cases confirm the expected format works correctly."}
{"id":"mssg-vh1.3","title":"Update README version history for 0.9.0","description":"Add v0.9.0 section to README.md version history with changelog:\n- Fixed missing mise tasks (verify, tests)\n- Added test coverage for content.rs edge cases\n- Reorganized mise.toml task structure\n- Fixed typos in documentation\n\nAcceptance Criteria:\n- [ ] v0.9.0 section added to README.md Version History\n- [ ] Date set to current date","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-29T23:42:47.517237+01:00","created_by":"l1x","updated_at":"2025-12-30T10:17:56.47761+01:00","closed_at":"2025-12-30T10:17:56.47761+01:00","close_reason":"Updated v0.9.0 changelog with all release changes","dependencies":[{"issue_id":"mssg-vh1.3","depends_on_id":"mssg-vh1.1","type":"blocks","created_at":"2025-12-29T23:43:00.648864+01:00","created_by":"daemon"},{"issue_id":"mssg-vh1.3","depends_on_id":"mssg-vh1.2","type":"blocks","created_at":"2025-12-29T23:43:00.741408+01:00","created_by":"daemon"}]}
{"id":"mssg-vh1.4","title":"Run full verification","description":"Run lint + tests to ensure release is stable\n\nAcceptance Criteria:\n- [ ] mise run verify passes\n- [ ] No warnings from clippy\n- [ ] All tests pass","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T23:42:47.631169+01:00","created_by":"l1x","updated_at":"2025-12-29T23:42:47.631169+01:00","dependencies":[{"issue_id":"mssg-vh1.4","depends_on_id":"mssg-vh1.1","type":"blocks","created_at":"2025-12-29T23:43:00.555677+01:00","created_by":"daemon"}]}
{"id":"mssg-vh1.5","title":"Create and push git tag v0.9.0","description":"Create annotated git tag and push to remote\n\nAcceptance Criteria:\n- [ ] git tag v0.9.0 created\n- [ ] Tag pushed to remote","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-29T23:42:47.751632+01:00","created_by":"l1x","updated_at":"2025-12-29T23:42:47.751632+01:00","dependencies":[{"issue_id":"mssg-vh1.5","depends_on_id":"mssg-vh1.3","type":"blocks","created_at":"2025-12-29T23:43:00.837912+01:00","created_by":"daemon"},{"issue_id":"mssg-vh1.5","depends_on_id":"mssg-vh1.4","type":"blocks","created_at":"2025-12-29T23:43:00.931362+01:00","created_by":"daemon"},{"issue_id":"mssg-vh1.5","depends_on_id":"mssg-vh1.6","type":"blocks","created_at":"2025-12-29T23:44:55.225581+01:00","created_by":"daemon"},{"issue_id":"mssg-vh1.5","depends_on_id":"mssg-vh1.10","type":"blocks","created_at":"2025-12-30T10:19:38.415393+01:00","created_by":"daemon"}]}
{"id":"mssg-vh1.6","title":"Migrate from chrono to time and kiters crates","description":"Replace chrono dependency with time and kiters crates for datetime handling.\n\n## Summary of Changes\n\n### Cargo.toml\n- Removed chrono dependency\n- Added kiters v0 for UTC timestamp formatting\n- Added time v0 with features: serde, serde-human-readable, parsing, formatting, macros\n- Updated tracing-subscriber to include env-filter and time features\n\n### Code Changes\n- **src/content.rs**: Migrated ContentMeta.date from DateTime\u003cFixedOffset\u003e to OffsetDateTime with RFC3339 serde\n- **src/sitemap.rs**: Updated format_url_entry to use time crate formatting\n- **src/utils.rs**: Updated add_date_prefix function to use time crate\n- **src/template.rs**: Added format_date_long() helper for date formatting\n- **src/main.rs**: Updated tracing initialization to use kiters::timestamp::get_utc_formatter()\n\n### Test Updates\n- All tests migrated to use time::macros::datetime!() macro\n- All 88 unit tests + 11 integration tests pass\n\nAcceptance Criteria:\n- [x] Remove chrono from Cargo.toml\n- [x] Add time and kiters dependencies\n- [x] Update all date/time handling code\n- [x] All tests pass","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-29T23:44:45.923147+01:00","created_by":"l1x","updated_at":"2025-12-30T00:30:29.39115+01:00","closed_at":"2025-12-30T00:30:29.391153+01:00"}
{"id":"mssg-vh1.7","title":"Benchmark basic-toml vs toml crate","description":"Compare performance of basic-toml (current) vs toml crate for config parsing.\n\n## Benchmark Results\n\n| Config Size | basic-toml | toml | Speedup |\n|-------------|------------|------|---------|\n| minimal | 5.52 µs | 2.85 µs | **1.94x** |\n| typical | 20.22 µs | 10.06 µs | **2.01x** |\n| large | 45.04 µs | 22.94 µs | **1.96x** |\n\n## Recommendation\n\nThe `toml` crate is consistently ~2x faster than `basic-toml` across all config sizes. Consider migrating to `toml` crate for better performance.\n\nNote: For a typical site config, we're talking about 20µs vs 10µs - both are fast enough that this won't be noticeable in practice. The difference becomes more relevant if parsing many TOML files.\n\n## Acceptance Criteria\n- [x] Benchmark code added to benches/\n- [x] Results documented with recommendation","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-30T00:29:08.887645+01:00","created_by":"l1x","updated_at":"2025-12-30T08:52:59.022761+01:00","closed_at":"2025-12-30T08:52:59.022766+01:00"}
{"id":"mssg-vh1.8","title":"Migrate from basic-toml to toml crate","description":"Replace basic-toml with toml crate for TOML parsing.\n\n## Rationale\n- basic-toml is **no longer maintained** (archived)\n- toml crate is ~2x faster (see benchmark mssg-vh1.7)\n- toml supports TOML 1.1 spec (basic-toml only 1.0)\n\n## Migration Guide\nSee docs/toml-migration.md for detailed comparison and steps.\n\n## Files to Modify\n- Cargo.toml (swap dependency)\n- src/config.rs (update error type, change basic_toml:: to toml::)\n- src/content.rs (change basic_toml:: to toml::)\n\n## Acceptance Criteria\n- [ ] basic-toml removed from dependencies\n- [ ] toml added to dependencies\n- [ ] All TOML parsing uses toml crate\n- [ ] All tests pass\n- [ ] Benchmarks still work (basic-toml in dev-dependencies)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T00:40:17.242715+01:00","created_by":"l1x","updated_at":"2025-12-30T08:44:51.061625+01:00","closed_at":"2025-12-30T08:44:51.061625+01:00","close_reason":"Migrated from basic-toml to toml crate. All 99 tests pass, benchmarks compile.","dependencies":[{"issue_id":"mssg-vh1.8","depends_on_id":"mssg-vh1.7","type":"blocks","created_at":"2025-12-30T00:40:23.241035+01:00","created_by":"daemon"}]}
{"id":"mssg-vh1.9","title":"Investigate 80MB release binary size","description":"The release binary is 80MB which seems large for a static site generator.\n\n## Current State\n- `target/release/marie-ssg` is 80MB\n- Release profile has size optimizations: `opt-level = \"s\"`, `lto = true`, `strip = \"symbols\"`, `panic = \"abort\"`\n\n## Investigation Findings\n\n### Binary Breakdown (Before)\n| Section | Size | Description |\n|---------|------|-------------|\n| `__const` | **74.3 MB** | Tree-sitter grammar parse tables |\n| `.text` | 7.1 MB | Actual executable code |\n| dSYM | 37 MB | Debug symbols (separate file) |\n\n### Root Cause\n`autumnus` crate includes **91 tree-sitter language grammars** by default. Each grammar embeds large parse tables as constant data.\n\n## Solution Applied\n\nUpdated Cargo.toml to use only documented languages (10 instead of 91):\n\n```toml\nautumnus = { version = \"0.7\", default-features = false, features = [\n    \"lang-bash\",\n    \"lang-css\",\n    \"lang-html\",\n    \"lang-javascript\",\n    \"lang-json\",\n    \"lang-python\",\n    \"lang-rust\",\n    \"lang-toml\",\n    \"lang-typescript\",\n    \"lang-yaml\",\n] }\n```\n\n## Results\n\n| Metric | Before | After | Reduction |\n|--------|--------|-------|-----------|\n| Binary size | 80 MB | 9 MB | **89%** |\n| `__const` section | 74.3 MB | 6.2 MB | **92%** |\n| Languages | 91 | 10 | **89%** |\n\nAll 99 tests pass.\n\n## Acceptance Criteria\n- [x] Identify top contributors to binary size\n- [x] Document findings\n- [x] Propose actionable optimizations if feasible\n- [x] Apply optimization - 89% size reduction achieved!","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-30T08:56:47.950454+01:00","created_by":"l1x","updated_at":"2025-12-30T09:39:47.685431+01:00","closed_at":"2025-12-30T09:39:47.685431+01:00","close_reason":"Reduced binary from 80MB to 9MB (89%) by limiting autumnus to 10 documented languages","dependencies":[{"issue_id":"mssg-vh1.9","depends_on_id":"mssg-vh1","type":"parent-child","created_at":"2025-12-30T08:56:47.95127+01:00","created_by":"daemon"}]}
{"id":"mssg-zku","title":"Syntax highlighter escaping bug: HTML entities rendered literally","description":"The markdown parser HTML-escapes content in code blocks (e.g., '\u003c' becomes '\u0026lt;'). The highlighter receives this escaped content and renders it literally, so code containing HTML shows '\u0026lt;' instead of '\u003c'.","status":"tombstone","priority":2,"issue_type":"bug","created_at":"2025-12-22T21:07:06.26345+01:00","updated_at":"2025-12-29T23:35:09.600228+01:00","close_reason":"Fixed by unescaping HTML entities (\u0026lt;, \u0026gt;, \u0026amp;, etc.) before passing code to the syntax highlighter","deleted_at":"2025-12-29T23:35:09.600228+01:00","deleted_by":"batch delete","delete_reason":"batch delete","original_type":"bug"}
